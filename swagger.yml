consumes:
- application/json
info:
  description: <div>Platform agnostic GSLB frontend</div><img src="./andromeda.png" />
  title: Andromeda
  version: 1.0.0
produces:
- application/json
swagger: "2.0"
basePath: /v1

parameters:
  marker:
    name: marker
    in: query
    type: string
    format: uuid
    description: Pagination ID of the last item in the previous list.
  limit:
    name: limit
    in: query
    type: integer
    description: Sets the page size.


paths:
  /domains:
    get:
      tags:
        - Domains
      summary: List domains
      parameters:
        - $ref: '#/parameters/marker'
        - $ref: '#/parameters/limit'
      responses:
        200:
          description: A JSON array of domains
          schema:
            type: object
            properties:
              domains:
                type: array
                items:
                  $ref: '#/definitions/domain'
              links:
                x-omitempty: true
                type: array
                items:
                  $ref: '#/definitions/link'
    post:
      tags:
        - Domains
      summary: Create new domain
      parameters:
        - in: body
          name: domain
          required: true
          schema:
            type: object
            required:
              - domain
            properties:
              domain:
                $ref: '#/definitions/domain'
      responses:
        201:
          description: Created domain.
          schema:
            type: object
            properties:
              domain:
                $ref: '#/definitions/domain'
        400:
          description: Bad request
          schema:
            $ref: '#/definitions/error'

  /domains/{domain_id}:
    parameters:
      - in: path
        name: domain_id
        required: true
        type: string
        format: uuid
        description: The UUID of the domain
    get:
      tags:
        - Domains
      summary: Show domain detail
      responses:
        200:
          description: Shows the details of a specific domain.
          schema:
            type: object
            properties:
              domain:
                $ref: '#/definitions/domain'
        404:
          description: Not Found
          schema:
            $ref: '#/definitions/error'
    put:
      tags:
        - Domains
      summary: Update a domain
      parameters:
        - in: body
          name: domain
          required: true
          schema:
            type: object
            required:
              - domain
            properties:
              domain:
                $ref: '#/definitions/domain'
      responses:
        202:
          description: Updated domain.
          schema:
            type: object
            properties:
              domain:
                $ref: '#/definitions/domain'
        404:
          description: Not Found
          schema:
            $ref: '#/definitions/error'
    delete:
      tags:
        - Domains
      summary: Delete a domain
      responses:
        204:
          description: Resource successfully deleted.
        404:
          description: Not Found
          schema:
            $ref: '#/definitions/error'

  /pools:
    get:
      tags:
        - Pools
      summary: List pools
      parameters:
        - $ref: '#/parameters/marker'
        - $ref: '#/parameters/limit'
      responses:
        200:
          description: A JSON array of pools
          schema:
            type: object
            properties:
              pools:
                type: array
                items:
                  $ref: '#/definitions/pool'
              links:
                x-omitempty: true
                type: array
                items:
                  $ref: '#/definitions/link'
    post:
      tags:
        - Pools
      summary: Create new pool
      parameters:
        - in: body
          name: pool
          required: true
          schema:
            type: object
            required:
              - pool
            properties:
              pool:
                $ref: '#/definitions/pool'
      responses:
        201:
          description: Created pool.
          schema:
            type: object
            properties:
              pool:
                $ref: '#/definitions/pool'
        400:
          description: Bad request
          schema:
            $ref: '#/definitions/error'

  /pools/{pool_id}:
    parameters:
      - in: path
        name: pool_id
        required: true
        type: string
        format: uuid
        description: The UUID of the pool
    get:
      tags:
        - Pools
      summary: Show pool detail
      responses:
        200:
          description: Shows the details of a specific pool.
          schema:
            type: object
            properties:
              pool:
                $ref: '#/definitions/pool'
        404:
          description: Not Found
          schema:
            $ref: '#/definitions/error'
    put:
      tags:
        - Pools
      summary: Update a pool
      parameters:
        - in: body
          name: pool
          required: true
          schema:
            type: object
            required:
              - pool
            properties:
              pool:
                $ref: '#/definitions/pool'
      responses:
        202:
          description: Updated pool.
          schema:
            type: object
            properties:
              pool:
                $ref: '#/definitions/pool'
        404:
          description: Not Found
          schema:
            $ref: '#/definitions/error'
    delete:
      tags:
        - Pools
      summary: Delete a pool
      responses:
        204:
          description: Resource successfully deleted.
        404:
          description: Not Found
          schema:
            $ref: '#/definitions/error'

  /datacenters:
    get:
      tags:
        - Datacenters
      summary: List datacenters
      parameters:
        - $ref: '#/parameters/marker'
        - $ref: '#/parameters/limit'
      responses:
        200:
          description: A JSON array of datacenters
          schema:
            type: object
            properties:
              datacenters:
                type: array
                items:
                  $ref: '#/definitions/datacenter'
              links:
                x-omitempty: true
                type: array
                items:
                  $ref: '#/definitions/link'
    post:
      tags:
        - Datacenters
      summary: Create new datacenter
      parameters:
        - in: body
          name: datacenter
          required: true
          schema:
            type: object
            required:
              - datacenter
            properties:
              datacenter:
                $ref: '#/definitions/datacenter'
      responses:
        201:
          description: Created datacenter.
          schema:
            type: object
            properties:
              datacenter:
                $ref: '#/definitions/datacenter'
        404:
          description: Not Found
          schema:
            $ref: '#/definitions/error'

  /datacenters/{datacenter_id}:
    parameters:
      - in: path
        name: datacenter_id
        required: true
        type: string
        format: uuid
        description: The UUID of the datacenter
    get:
      tags:
        - Datacenters
      summary: Show datacenter detail
      responses:
        200:
          description: Shows the details of a specific datacenter.
          schema:
            type: object
            properties:
              datacenter:
                $ref: '#/definitions/datacenter'
        404:
          description: Not Found
          schema:
            $ref: '#/definitions/error'
    put:
      tags:
        - Datacenters
      summary: Update a datacenter
      parameters:
        - in: body
          name: datacenter
          required: true
          schema:
            type: object
            required:
              - datacenter
            properties:
              datacenter:
                $ref: '#/definitions/datacenter'
      responses:
        202:
          description: Updated datacenter.
          schema:
            type: object
            properties:
              datacenter:
                $ref: '#/definitions/datacenter'
        404:
          description: Not Found
          schema:
            $ref: '#/definitions/error'
    delete:
      tags:
        - Datacenters
      summary: Delete a datacenter
      responses:
        204:
          description: Resource successfully deleted.
        404:
          description: Not Found
          schema:
            $ref: '#/definitions/error'

  /datacenters/{datacenter_id}/members:
    parameters:
      - in: path
        name: datacenter_id
        required: true
        type: string
        format: uuid
        description: The UUID of the datacenter
    get:
      tags:
        - Members
      summary: List members
      parameters:
        - $ref: '#/parameters/marker'
        - $ref: '#/parameters/limit'
      responses:
        200:
          description: A JSON array of members
          schema:
            type: object
            properties:
              members:
                type: array
                items:
                  $ref: '#/definitions/member'
              links:
                x-omitempty: true
                type: array
                items:
                  $ref: '#/definitions/link'
    post:
      tags:
        - Members
      summary: Create new member
      parameters:
        - in: body
          name: member
          required: true
          schema:
            type: object
            required:
              - member
            properties:
              member:
                $ref: '#/definitions/member'
      responses:
        201:
          description: Created member.
          schema:
            type: object
            properties:
              member:
                $ref: '#/definitions/member'

  /datacenters/{datacenter_id}/members/{member_id}:
    parameters:
      - in: path
        name: datacenter_id
        required: true
        type: string
        format: uuid
        description: The UUID of the datacenter
      - in: path
        name: member_id
        required: true
        type: string
        format: uuid
        description: The UUID of the member
    get:
      tags:
        - Members
      summary: Show member detail
      responses:
        200:
          description: Shows the details of a specific member.
          schema:
            type: object
            properties:
              member:
                $ref: '#/definitions/member'
        404:
          description: Not Found
          schema:
            $ref: '#/definitions/error'
    put:
      tags:
        - Members
      summary: Update a member
      parameters:
        - in: body
          name: member
          required: true
          schema:
            type: object
            required:
              - member
            properties:
              member:
                $ref: '#/definitions/member'
      responses:
        202:
          description: Updated member.
          schema:
            type: object
            properties:
              member:
                $ref: '#/definitions/member'
        404:
          description: Not Found
          schema:
            $ref: '#/definitions/error'
    delete:
      tags:
        - Members
      summary: Delete a member
      responses:
        204:
          description: Resource successfully deleted.
        404:
          description: Not Found
          schema:
            $ref: '#/definitions/error'

  /monitors:
    get:
      tags:
        - Monitors
      summary: List monitors
      parameters:
        - $ref: '#/parameters/marker'
        - $ref: '#/parameters/limit'
      responses:
        200:
          description: A JSON array of monitors
          schema:
            type: object
            properties:
              monitors:
                type: array
                items:
                  $ref: '#/definitions/monitor'
              links:
                x-omitempty: true
                type: array
                items:
                  $ref: '#/definitions/link'
    post:
      tags:
        - Monitors
      summary: Create new monitor
      parameters:
        - in: body
          name: monitor
          required: true
          schema:
            type: object
            required:
              - monitor
            properties:
              monitor:
                $ref: '#/definitions/monitor'
      responses:
        201:
          description: Created monitor.
          schema:
            type: object
            properties:
              monitor:
                $ref: '#/definitions/monitor'
        404:
          description: Not Found
          schema:
            $ref: '#/definitions/error'
  /monitors/{monitor_id}:
    parameters:
      - in: path
        name: monitor_id
        required: true
        type: string
        format: uuid
        description: The UUID of the monitor
    get:
      tags:
        - Monitors
      summary: Show monitor detail
      responses:
        200:
          description: Shows the details of a specific monitor.
          schema:
            type: object
            properties:
              monitor:
                $ref: '#/definitions/monitor'
        404:
          description: Not Found
          schema:
            $ref: '#/definitions/error'
    put:
      tags:
        - Monitors
      summary: Update a monitor
      parameters:
        - in: body
          name: monitor
          required: true
          schema:
            type: object
            required:
              - monitor
            properties:
              monitor:
                $ref: '#/definitions/monitor'
      responses:
        202:
          description: Updated monitor.
          schema:
            type: object
            properties:
              monitor:
                $ref: '#/definitions/monitor'
        404:
          description: Not Found
          schema:
            $ref: '#/definitions/error'
    delete:
      tags:
        - Monitors
      summary: Delete a monitor
      responses:
        204:
          description: Resource successfully deleted.
        404:
          description: Not Found
          schema:
            $ref: '#/definitions/error'

definitions:
  domain:
    type: object
    description: A representation of a domain
    required:
      - fqdn
    properties:
      id:
        type: string
        format: uuid
        description: The id of the resource.
        readOnly: true
      name:
        type: string
        description: Human-readable name of the resource.
        x-nullable: true
      admin_state_up:
        type: boolean
        description: The administrative state of the resource, which is up (true) or down (false). Default is true.
        default: true
      status:
        type: string
        enum:
          - ONLINE
          - DOWN
        readOnly: true
      created_at:
        type: string
        format: dateTime
        description: The UTC date and timestamp when the resource was created.
        readOnly: true
        example: 2020-05-11T17:21:34
      updated_at:
        type: string
        format: dateTime
        description: The UTC date and timestamp when the resource was created.
        readOnly: true
        example: 2020-09-09T14:52:15
      provisioning_status:
        type: string
        enum:
          - PENDING
          - ACTIVE
          - ERROR
        readOnly: true
      fqdn:
        type: string
        format: hostname
        description: Fully-Qualified Host Name.
        example: example.org
        maxLength: 512
      mode:
        type: string
        description: Load balancing method to use for the references pools.
        enum:
          - WEIGHTED
          - ROUND_ROBIN
          - GEOGRAPHIC
          - AVAILABILITY
        default: ROUND_ROBIN
      record_type:
        type: string
        description: DNS Record type to use.
        enum:
          - A
          - AAAA
          - CNAME
          - MX
        default: A
      aliases:
        type: array
        items:
          format: string
          type: string
          example: alias.example.com
      pools:
        type: array
        items:
          type: string
          format: uuid
          description: Pool that this domain uses for load balancing.
      provider:
        type: string
        description: Provider driver for the backend solution
        example: akamai
        enum:
          - akamai
          - f5

  pool:
    type: object
    properties:
      id:
        type: string
        format: uuid
        description: The id of the resource.
        readOnly: true
      name:
        type: string
        description: Human-readable name of the resource.
        maxLength: 255
        x-nullable: true
      admin_state_up:
        type: boolean
        description: The administrative state of the resource, which is up (true) or down (false). Default is true.
        default: true
      status:
        type: string
        enum:
          - ONLINE
          - DOWN
        readOnly: true
      created_at:
        type: string
        format: dateTime
        description: The UTC date and timestamp when the resource was created.
        readOnly: true
        example: 2020-05-11 17:21:34
      updated_at:
        type: string
        format: dateTime
        description: The UTC date and timestamp when the resource was created.
        readOnly: true
        example: 2020-09-09 14:52:15
      provisioning_status:
        type: string
        enum:
          - PENDING
          - ACTIVE
          - ERROR
        readOnly: true
      datacenters:
        type: array
        readOnly: true
        description: Array of datacenter-ids that this pool uses for load balancing.
        items:
          format: uuid
          type: string
      domains:
        type: array
        readOnly: true
        description: Array of domains assigned to this pool
        items:
          type: string
          format: uuid
          description: Domain ID

  datacenter:
    type: object
    required:
      - pool_id
    properties:
      id:
        type: string
        format: uuid
        description: The id of the resource.
        readOnly: true
      name:
        type: string
        description: Human-readable name of the resource.
        maxLength: 255
        x-nullable: true
      admin_state_up:
        type: boolean
        description: The administrative state of the resource, which is up (true) or down (false). Default is true.
        default: true
      created_at:
        type: string
        format: dateTime
        description: The UTC date and timestamp when the resource was created.
        readOnly: true
        example: 2020-05-11T17:21:34
      updated_at:
        type: string
        format: dateTime
        description: The UTC date and timestamp when the resource was created.
        readOnly: true
        example: 2020-09-09T14:52:15
      provisioning_status:
        type: string
        enum:
          - PENDING
          - ACTIVE
          - ERROR
        readOnly: true
      pool_id:
        type: string
        format: uuid
        description: The id of the associated pool.
      weight:
        type: integer
        default: 1
        minimum: 1
        maximum: 255
        description: Weight of the datacenter. Only applicable to *WEIGHTED* domain mode.
      continent:
        type: string
        maxLength: 255
        example: EU
      country:
        type: string
        maxLength: 255
        example: DE
      city:
        type: string
        maxLength: 255
        example: Berlin
      state_or_province:
        type: string
        maxLength: 255
        example: Berlin
      latitude:
        type: number
        format: float
        example: 52.526055
      longitude:
        type: number
        format: float
        example: 13.403454

  member:
    type: object
    required:
      - address
    properties:
      id:
        type: string
        format: uuid
        description: The id of the resource.
        readOnly: true
      name:
        type: string
        description: Human-readable name of the resource.
        maxLength: 255
        x-nullable: true
      admin_state_up:
        type: boolean
        description: The administrative state of the resource, which is up (true) or down (false). Default is true.
        default: true
      created_at:
        type: string
        format: dateTime
        description: The UTC date and timestamp when the resource was created.
        readOnly: true
        example: 2020-05-11T17:21:34
      updated_at:
        type: string
        format: dateTime
        description: The UTC date and timestamp when the resource was created.
        readOnly: true
        example: 2020-09-09T14:52:15
      provisioning_status:
        type: string
        enum:
          - PENDING
          - ACTIVE
          - ERROR
        readOnly: true
      status:
        type: string
        enum:
          - ONLINE
          - NO_MONITOR
          - DOWN
        readOnly: true
      port:
        type: integer
        description: L4 Port to use (optional)
        example: 80
        minimum: 0
        maximum: 65535
      address:
        type: string
        format: ipv4
        description: Address to use.
        example: 1.2.3.4

  monitor:
    type: object
    required:
      - pool_id
    properties:
      id:
        type: string
        format: uuid
        description: The id of the resource.
        readOnly: true
      name:
        type: string
        description: Human-readable name of the resource.
        maxLength: 255
        x-nullable: true
      admin_state_up:
        type: boolean
        description: The administrative state of the resource, which is up (true) or down (false). Default is true.
        default: true
      created_at:
        type: string
        format: dateTime
        description: The UTC date and timestamp when the resource was created.
        readOnly: true
        example: 2020-05-11T17:21:34
      updated_at:
        type: string
        format: dateTime
        description: The UTC date and timestamp when the resource was created.
        readOnly: true
        example: 2020-09-09T14:52:15
      provisioning_status:
        type: string
        enum:
          - PENDING
          - ACTIVE
          - ERROR
        readOnly: true
      type:
        type: string
        description: Type of the health check monitor.
        default: ICMP
        enum:
          - HTTP
          - HTTPS
          - ICMP
          - TCP
          - UDP
        example: HTTP
      interval:
        type: integer
        description: The interval, in seconds, between health checks.
        example: 10
        minimum: 0
        maximum: 86399
        default: 60
      timeout:
        type: integer
        description: The time in total, in seconds, after which a health check times out.
        example: 30
        minimum: 0
        maximum: 86400
        default: 180
      pool_id:
        type: string
        format: uuid
        description: ID of the pool to check members
      send:
        type: string
        description: Specifies the text string that the monitor sends to the target member.
        maxLength: 255
        example: HEAD / HTTP/1.0\r\n\r\n
        x-nullable: true
      receive:
        type: string
        description: Specifies the text string that the monitor expects to receive from the target member.
        maxLength: 255
        example: HTTP/1.
        x-nullable: true

  error:
    type: object
    properties:
      message:
        type: string
        example: An example error message
      code:
        description: HTTP Error code
        example: 404
        type: integer

  link:
    type: object
    readOnly: true
    properties:
      href:
        type: string
        format: uri
      rel:
        type: string
        enum:
          - next
          - previous

tags:
  - name: Domains
    description: Domains are the highest level of entities defining DNS endpoints to be load balanced.
  - name: Pools
    description: Pools are logical collections of datacenters hosting target applications.
  - name: Datacenters
    description: Datacenter are collections of Members that share the same geographical location.
  - name: Members
    description: Members are IP/Port endpoints of the applications to be load balanced.
  - name: Monitors
    description: Monitors are health checks that influce load balancing decisions.